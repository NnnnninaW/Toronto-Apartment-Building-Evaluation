---
title: "Why Building Age is not Considered when Evaluating Apartment Building Safety^[Code and Data are available at:https://github.com/NnnnninaW/Toronto-Apartment-Building-Evaluation.git] "
author: "Sijian Wu"
date: "6 Feburary 2022"
output: pdf_document
abstract: "My abstract"
bibliography: reference.bib
---

# Table of Contents
### 1  Introduction\
------------------------------------------------------------------------------------------------2

### 2  Data
#### 2.1 Data Source\
------------------------------------------------------------------------------------------------6

#### 2.2 Methodology and Data Collection

#### 2.3 Data Characteristics


### Bibliography
------------------------------------------------------------------------------------------------21


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE)

```


```{r, include=FALSE}
library(opendatatoronto)
library(dplyr)
library(tidyverse)
library(kableExtra)
library(GGally)
library(ggplot2)
library(car)

# get package
package <- show_package("4ef82789-e038-44ef-a478-a8f3590c3eb1")
package

# get all resources for this package
resources <- list_package_resources("4ef82789-e038-44ef-a478-a8f3590c3eb1")

# identify datastore resources; by default, Toronto Open Data sets datastore resource format to CSV for non-geospatial and GeoJSON for geospatial resources
datastore_resources <- filter(resources, tolower(format) %in% c('csv', 'geojson'))

# load the first datastore resource as a sample
data <- filter(datastore_resources, row_number()==1) %>% get_resource()
data
```

```{r, include=FALSE}
#Data Preparation
#Checking some basic characteristics of the original data like type of observations and class, to see if cleaning process is needed for my analysis
glimpse(data)
unique(data$YEAR_REGISTERED)
unique(data$YEAR_EVALUATED)
unique(data$YEAR_BUILT)
unique(data$PROPERTY_TYPE)
sapply(data, class)


#Changing the YEAR_BUILT,YEAR_EVALUATED, CONFIRMED_STOREYS, CONFIRMED_UNITS into numerical variables for further cleaning
data$YEAR_BUILT <- as.numeric(data$YEAR_BUILT)
class(data$YEAR_BUILT)
data$YEAR_EVALUATED <- as.numeric(data$YEAR_EVALUATED)
class(data$YEAR_EVALUATED)

data$CONFIRMED_STOREYS <- as.numeric(data$CONFIRMED_STOREYS)
class(data$CONFIRMED_STOREYS)
data$CONFIRMED_UNITS <- as.numeric(data$CONFIRMED_UNITS)
class(data$CONFIRMED_UNITS)

```

```{r, include=FALSE}
#Data Cleaning Section
data_cleaned <- data %>%
  mutate_at(c(13:35,37,38), as.numeric)%>% 
  #Convert variables involved in calculation of the final score into numerical variables for analysis
  filter(!is.na(YEAR_EVALUATED), !is.na(YEAR_BUILT))%>%
  #Removing observations that has not applicable information of time for evaluation and time built.
  filter(CONFIRMED_STOREYS >= 3 || CONFIRMED_UNITS >= 10)%>%
  #According  to the RentSafeTO, this program is fore Apartment Building with three or more storey or 10 or more units to comply with building maintenance standards. 
  mutate(Building_Age_at_Evaluation = YEAR_EVALUATED - YEAR_BUILT)%>%
#Creating a New Variable to show the building age when encountering the evaluation.
  mutate(Distance_to_DT = sqrt((LATITUDE-43.642567)^2+(LONGITUDE+79.387054)^2)*110) %>%
#Create a single measurement for location as distance to downtown using CN Tower (latitude = 43.642567,-79.387054) as the benchmark, transform degree to km(*110).
  select(c(6,13,15:35,41,42))
  
  
data_cleaned
sapply(data_cleaned, class)
summary(data_cleaned)
colnames(data_cleaned)
```

\newpage
# Introduction
Apartment building safety is essential for both landlords and tenant. 
The City of Toronto ensures that tenants live in safe, well-maintained buildings through RentSafeTO: Apartment Building Standards, a bylaw enforcement program established in 2017. The program covers buildings that are three or more storey and ten or more units. There is no cost to the building owner for a City-initiated RentSafeTO building evaluation, as it is included in the registration and yearly renewal fee[@TO].


During evaluations, Bylaw Enforcement Officers inspect common areas, mechanical and security systems, parking and exterior grounds. The bylaw enforcement officer will take notes and photographs of their inspection to upload to the City’s mobile investigation application. 


 Staff are also onsite during audits to engage with tenants and document concerns regarding property standards within units. The building owner will also be provided with a report of the inspection findings and the building’s evaluation score. Details about the most recent building evaluation must be posted on the Tenant Notification Board. They must also be shared with all prospective tenants. Building owners must comply with the bylaws within the program or face financial penalties[@TO]. 



# 2 Data
## 2.1 Data Source
To analyze the current status of building safety evaluation in Toronto, I utilized the Apartment Building Evaluation data[@data] from Open Data Toronto [@open]. This dataset contains building evaluation scores for buildings registered with RentSafeTO. Each item is inspected and assigned a score from one to five, with one being the lowest and five being the highest. If an item is not applicable to the building at the time of evaluation, the score will show as blank in the dataset[@data].\

The overall score is determined by dividing the sum of all assigned scores of each item by 5 multiplying the number of unique items reviewed[@data]. Buildings that score 50 per cent or less on the evaluation must undergo a comprehensive inspection and audit of all common areas. On the day of the audit, bylaw enforcement officers set up a tenant engagement station to educate tenants on RentSafeTO and document concerns they may have regarding issues in their unit or common areas of their building. After the audit, investigations are opened for all service requests received[@TO].\

Buildings must undergo evaluation at least once every three years. If buildings score 65 per cent or less, then the next evaluation will take place within one year. If the score is between 66 – 85 per cent, the next evaluation will take place within two years and if buildings score 86 percent and above the next evaluation with be within three years[@TO].


## Methodology and Data Collection

## Data Characteristic

```{r, echo=FALSE, message=FALSE }
Mean <- lapply(data_cleaned[c(2,3)], mean)
Standard_Deviation <- lapply(data_cleaned[c(2,3)], sd)
cbind(Mean, Standard_Deviation) %>% 
  knitr::kable(digits = 4)

```



```{r, echo=FALSE}
Score <- data_cleaned %>%  
  ggplot(aes(x = SCORE)) +
  geom_histogram(aes(y=..density..), bins=20, colour = "black", fill = "light yellow") + 
   labs(title = "Toronto Apartment Building Evaluation Score Distribution Histogram",
        x = "Evaluation Score",
        y = "Density")+
  geom_density()
Score
```


```{r, echo=FALSE}
ggplot(data = data_cleaned, aes(x = PROPERTY_TYPE)) +
  geom_bar(fill = "blue", color = "black", alpha = 0.2) +
  labs(title = "Overview of Different Property Types under Evaluation", y = "Count", x = "Property Type")

```

```{r, echo=FALSE}
data_cleaned[,c(2,3,24,25)] %>% 
  na.omit() %>% 
  ggpairs()

```

```{r, echo=FALSE, message=FALSE}
ggplot(data_cleaned, aes(x=Building_Age_at_Evaluation, y=SCORE))+
geom_point() +
geom_smooth(method = lm, se = FALSE)+
labs( x = "xx", y ="ss" )
```

# Reference



